(function(e){String.prototype.trim===e&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.reduce===e&&(Array.prototype.reduce=function(t){if(this===void 0||null===this)throw new TypeError;var n,i=Object(this),r=i.length>>>0,o=0;if("function"!=typeof t)throw new TypeError;if(0==r&&1==arguments.length)throw new TypeError;if(arguments.length>=2)n=arguments[1];else for(;;){if(o in i){n=i[o++];break}if(++o>=r)throw new TypeError}for(;r>o;)o in i&&(n=t.call(e,n,i[o],o,i)),o++;return n})})();var Zepto=function(){function e(e){return null==e?e+"":J[X.call(e)]||"object"}function t(t){return"function"==e(t)}function n(e){return null!=e&&e==e.window}function i(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function r(t){return"object"==e(t)}function o(e){return r(e)&&!n(e)&&e.__proto__==Object.prototype}function a(e){return e instanceof Array}function s(e){return"number"==typeof e.length}function l(e){return A.call(e,function(e){return null!=e})}function d(e){return e.length>0?S.fn.concat.apply([],e):e}function u(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function c(e){return e in N?N[e]:N[e]=RegExp("(^|\\s)"+e+"(\\s|$)")}function f(e,t){return"number"!=typeof t||O[u(e)]?t:t+"px"}function p(e){var t,n;return F[e]||(t=M.createElement(e),M.body.appendChild(t),n=L(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),F[e]=n),F[e]}function h(e){return"children"in e?I.call(e.children):S.map(e.childNodes,function(e){return 1==e.nodeType?e:x})}function m(e,t,n){for(E in t)n&&(o(t[E])||a(t[E]))?(o(t[E])&&!o(e[E])&&(e[E]={}),a(t[E])&&!a(e[E])&&(e[E]=[]),m(e[E],t[E],n)):t[E]!==x&&(e[E]=t[E])}function v(e,t){return t===x?S(e):S(e).filter(t)}function g(e,n,i,r){return t(n)?n.call(e,i,r):n}function b(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function y(e,t){var n=e.className,i=n&&n.baseVal!==x;return t===x?i?n.baseVal:n:(i?n.baseVal=t:e.className=t,x)}function w(e){var t;try{return e?"true"==e||("false"==e?!1:"null"==e?null:isNaN(t=Number(e))?/^[\[\{]/.test(e)?S.parseJSON(e):e:t):e}catch(n){return e}}function T(e,t){t(e);for(var n in e.childNodes)T(e.childNodes[n],t)}var x,E,S,_,k,C,$=[],I=$.slice,A=$.filter,M=window.document,F={},N={},L=M.defaultView.getComputedStyle,O={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},D=/^\s*<(\w+|!)[^>]*>/,P=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,R=/^(?:body|html)$/i,j=["val","css","html","text","data","width","height","offset"],H=["after","prepend","before","append"],V=M.createElement("table"),z=M.createElement("tr"),q={tr:M.createElement("tbody"),tbody:V,thead:V,tfoot:V,td:z,th:z,"*":M.createElement("div")},U=/complete|loaded|interactive/,Z=/^\.([\w-]+)$/,B=/^#([\w-]*)$/,W=/^[\w-]+$/,J={},X=J.toString,Y={},G=M.createElement("div");return Y.matches=function(e,t){if(!e||1!==e.nodeType)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var i,r=e.parentNode,o=!r;return o&&(r=G).appendChild(e),i=~Y.qsa(r,t).indexOf(e),o&&G.removeChild(e),i},k=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},C=function(e){return A.call(e,function(t,n){return e.indexOf(t)==n})},Y.fragment=function(e,t,n){e.replace&&(e=e.replace(P,"<$1></$2>")),t===x&&(t=D.test(e)&&RegExp.$1),t in q||(t="*");var i,r,a=q[t];return a.innerHTML=""+e,r=S.each(I.call(a.childNodes),function(){a.removeChild(this)}),o(n)&&(i=S(r),S.each(n,function(e,t){j.indexOf(e)>-1?i[e](t):i.attr(e,t)})),r},Y.Z=function(e,t){return e=e||[],e.__proto__=S.fn,e.selector=t||"",e},Y.isZ=function(e){return e instanceof Y.Z},Y.init=function(e,n){if(e){if(t(e))return S(M).ready(e);if(Y.isZ(e))return e;var i;if(a(e))i=l(e);else if(r(e))i=[o(e)?S.extend({},e):e],e=null;else if(D.test(e))i=Y.fragment(e.trim(),RegExp.$1,n),e=null;else{if(n!==x)return S(n).find(e);i=Y.qsa(M,e)}return Y.Z(i,e)}return Y.Z()},S=function(e,t){return Y.init(e,t)},S.extend=function(e){var t,n=I.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){m(e,n,t)}),e},Y.qsa=function(e,t){var n;return i(e)&&B.test(t)?(n=e.getElementById(RegExp.$1))?[n]:[]:1!==e.nodeType&&9!==e.nodeType?[]:I.call(Z.test(t)?e.getElementsByClassName(RegExp.$1):W.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t))},S.contains=function(e,t){return e!==t&&e.contains(t)},S.type=e,S.isFunction=t,S.isWindow=n,S.isArray=a,S.isPlainObject=o,S.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},S.inArray=function(e,t,n){return $.indexOf.call(t,e,n)},S.camelCase=k,S.trim=function(e){return e.trim()},S.uuid=0,S.support={},S.expr={},S.map=function(e,t){var n,i,r,o=[];if(s(e))for(i=0;e.length>i;i++)n=t(e[i],i),null!=n&&o.push(n);else for(r in e)n=t(e[r],r),null!=n&&o.push(n);return d(o)},S.each=function(e,t){var n,i;if(s(e)){for(n=0;e.length>n;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(i in e)if(t.call(e[i],i,e[i])===!1)return e;return e},S.grep=function(e,t){return A.call(e,t)},window.JSON&&(S.parseJSON=JSON.parse),S.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){J["[object "+t+"]"]=t.toLowerCase()}),S.fn={forEach:$.forEach,reduce:$.reduce,push:$.push,sort:$.sort,indexOf:$.indexOf,concat:$.concat,map:function(e){return S(S.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return S(I.apply(this,arguments))},ready:function(e){return U.test(M.readyState)?e(S):M.addEventListener("DOMContentLoaded",function(){e(S)},!1),this},get:function(e){return e===x?I.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return $.every.call(this,function(t,n){return e.call(t,n,t)!==!1}),this},filter:function(e){return t(e)?this.not(this.not(e)):S(A.call(this,function(t){return Y.matches(t,e)}))},add:function(e,t){return S(C(this.concat(S(e,t))))},is:function(e){return this.length>0&&Y.matches(this[0],e)},not:function(e){var n=[];if(t(e)&&e.call!==x)this.each(function(t){e.call(this,t)||n.push(this)});else{var i="string"==typeof e?this.filter(e):s(e)&&t(e.item)?I.call(e):S(e);this.forEach(function(e){0>i.indexOf(e)&&n.push(e)})}return S(n)},has:function(e){return this.filter(function(){return r(e)?S.contains(this,e):S(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!r(e)?e:S(e)},last:function(){var e=this[this.length-1];return e&&!r(e)?e:S(e)},find:function(e){var t,n=this;return t="object"==typeof e?S(e).filter(function(){var e=this;return $.some.call(n,function(t){return S.contains(t,e)})}):1==this.length?S(Y.qsa(this[0],e)):this.map(function(){return Y.qsa(this,e)})},closest:function(e,t){var n=this[0],r=!1;for("object"==typeof e&&(r=S(e));n&&!(r?r.indexOf(n)>=0:Y.matches(n,e));)n=n!==t&&!i(n)&&n.parentNode;return S(n)},parents:function(e){for(var t=[],n=this;n.length>0;)n=S.map(n,function(e){return(e=e.parentNode)&&!i(e)&&0>t.indexOf(e)?(t.push(e),e):x});return v(t,e)},parent:function(e){return v(C(this.pluck("parentNode")),e)},children:function(e){return v(this.map(function(){return h(this)}),e)},contents:function(){return this.map(function(){return I.call(this.childNodes)})},siblings:function(e){return v(this.map(function(e,t){return A.call(h(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return S.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null),"none"==L(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var n=t(e);if(this[0]&&!n)var i=S(e).get(0),r=i.parentNode||this.length>1;return this.each(function(t){S(this).wrapAll(n?e.call(this,t):r?i.cloneNode(!0):i)})},wrapAll:function(e){if(this[0]){S(this[0]).before(e=S(e));for(var t;(t=e.children()).length;)e=t.first();S(e).append(this)}return this},wrapInner:function(e){var n=t(e);return this.each(function(t){var i=S(this),r=i.contents(),o=n?e.call(this,t):e;r.length?r.wrapAll(o):i.append(o)})},unwrap:function(){return this.parent().each(function(){S(this).replaceWith(S(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=S(this);(e===x?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return S(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return S(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return e===x?this.length>0?this[0].innerHTML:null:this.each(function(t){var n=this.innerHTML;S(this).empty().append(g(this,e,t,n))})},text:function(e){return e===x?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=e})},attr:function(e,t){var n;return"string"==typeof e&&t===x?0==this.length||1!==this[0].nodeType?x:"value"==e&&"INPUT"==this[0].nodeName?this.val():!(n=this[0].getAttribute(e))&&e in this[0]?this[0][e]:n:this.each(function(n){if(1===this.nodeType)if(r(e))for(E in e)b(this,E,e[E]);else b(this,e,g(this,t,n,this.getAttribute(e)))})},removeAttr:function(e){return this.each(function(){1===this.nodeType&&b(this,e)})},prop:function(e,t){return t===x?this[0]&&this[0][e]:this.each(function(n){this[e]=g(this,t,n,this[e])})},data:function(e,t){var n=this.attr("data-"+u(e),t);return null!==n?w(n):x},val:function(e){return e===x?this[0]&&(this[0].multiple?S(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(t){this.value=g(this,e,t,this.value)})},offset:function(e){if(e)return this.each(function(t){var n=S(this),i=g(this,e,t,n.offset()),r=n.offsetParent().offset(),o={top:i.top-r.top,left:i.left-r.left};"static"==n.css("position")&&(o.position="relative"),n.css(o)});if(0==this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,n){if(2>arguments.length&&"string"==typeof t)return this[0]&&(this[0].style[k(t)]||L(this[0],"").getPropertyValue(t));var i="";if("string"==e(t))n||0===n?i=u(t)+":"+f(t,n):this.each(function(){this.style.removeProperty(u(t))});else for(E in t)t[E]||0===t[E]?i+=u(E)+":"+f(E,t[E])+";":this.each(function(){this.style.removeProperty(u(E))});return this.each(function(){this.style.cssText+=";"+i})},index:function(e){return e?this.indexOf(S(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return $.some.call(this,function(e){return this.test(y(e))},c(e))},addClass:function(e){return this.each(function(t){_=[];var n=y(this),i=g(this,e,t,n);i.split(/\s+/g).forEach(function(e){S(this).hasClass(e)||_.push(e)},this),_.length&&y(this,n+(n?" ":"")+_.join(" "))})},removeClass:function(e){return this.each(function(t){return e===x?y(this,""):(_=y(this),g(this,e,t,_).split(/\s+/g).forEach(function(e){_=_.replace(c(e)," ")}),y(this,_.trim()),x)})},toggleClass:function(e,t){return this.each(function(n){var i=S(this),r=g(this,e,n,y(this));r.split(/\s+/g).forEach(function(e){(t===x?!i.hasClass(e):t)?i.addClass(e):i.removeClass(e)})})},scrollTop:function(){return this.length?"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY:x},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),i=R.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(S(e).css("margin-top"))||0,n.left-=parseFloat(S(e).css("margin-left"))||0,i.top+=parseFloat(S(t[0]).css("border-top-width"))||0,i.left+=parseFloat(S(t[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||M.body;e&&!R.test(e.nodeName)&&"static"==S(e).css("position");)e=e.offsetParent;return e})}},S.fn.detach=S.fn.remove,["width","height"].forEach(function(e){S.fn[e]=function(t){var r,o=this[0],a=e.replace(/./,function(e){return e[0].toUpperCase()});return t===x?n(o)?o["inner"+a]:i(o)?o.documentElement["offset"+a]:(r=this.offset())&&r[e]:this.each(function(n){o=S(this),o.css(e,g(this,t,n,o[e]()))})}}),H.forEach(function(t,n){var i=n%2;S.fn[t]=function(){var t,r,o=S.map(arguments,function(n){return t=e(n),"object"==t||"array"==t||null==n?n:Y.fragment(n)}),a=this.length>1;return 1>o.length?this:this.each(function(e,t){r=i?t:t.parentNode,t=0==n?t.nextSibling:1==n?t.firstChild:2==n?t:null,o.forEach(function(e){if(a)e=e.cloneNode(!0);else if(!r)return S(e).remove();T(r.insertBefore(e,t),function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},S.fn[i?t+"To":"insert"+(n?"Before":"After")]=function(e){return S(e)[t](this),this}}),Y.Z.prototype=S.fn,Y.uniq=C,Y.deserializeValue=w,S.zepto=Y,S}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(e){function t(e){var t=this.os={},n=this.browser={},i=e.match(/WebKit\/([\d.]+)/),r=e.match(/(Android)\s+([\d.]+)/),o=e.match(/(iPad).*OS\s([\d_]+)/),a=!o&&e.match(/(iPhone\sOS)\s([\d_]+)/),s=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),l=s&&e.match(/TouchPad/),d=e.match(/Kindle\/([\d.]+)/),u=e.match(/Silk\/([\d._]+)/),c=e.match(/(BlackBerry).*Version\/([\d.]+)/),f=e.match(/(BB10).*Version\/([\d.]+)/),p=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),h=e.match(/PlayBook/),m=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),v=e.match(/Firefox\/([\d.]+)/);(n.webkit=!!i)&&(n.version=i[1]),r&&(t.android=!0,t.version=r[2]),a&&(t.ios=t.iphone=!0,t.version=a[2].replace(/_/g,".")),o&&(t.ios=t.ipad=!0,t.version=o[2].replace(/_/g,".")),s&&(t.webos=!0,t.version=s[2]),l&&(t.touchpad=!0),c&&(t.blackberry=!0,t.version=c[2]),f&&(t.bb10=!0,t.version=f[2]),p&&(t.rimtabletos=!0,t.version=p[2]),h&&(n.playbook=!0),d&&(t.kindle=!0,t.version=d[1]),u&&(n.silk=!0,n.version=u[1]),!u&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),m&&(n.chrome=!0,n.version=m[1]),v&&(n.firefox=!0,n.version=v[1]),t.tablet=!!(o||h||r&&!e.match(/Mobile/)||v&&e.match(/Tablet/)),t.phone=!(t.tablet||!(r||a||s||c||f||m&&e.match(/Android/)||m&&e.match(/CriOS\/([\d.]+)/)||v&&e.match(/Mobile/)))}t.call(e,navigator.userAgent),e.__detect=t}(Zepto),function(e){function t(e){return e._zid||(e._zid=p++)}function n(e,n,o,a){if(n=i(n),n.ns)var s=r(n.ns);return(f[t(e)]||[]).filter(function(e){return!(!e||n.e&&e.e!=n.e||n.ns&&!s.test(e.ns)||o&&t(e.fn)!==t(o)||a&&e.sel!=a)})}function i(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function r(e){return RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function o(t,n,i){"string"!=e.type(t)?e.each(t,i):t.split(/\s/).forEach(function(e){i(e,n)})}function a(e,t){return e.del&&("focus"==e.e||"blur"==e.e)||!!t}function s(e){return m[e]||e}function l(n,r,l,d,u,c){var p=t(n),h=f[p]||(f[p]=[]);o(r,l,function(t,r){var o=i(t);o.fn=r,o.sel=d,o.e in m&&(r=function(t){var n=t.relatedTarget;return!n||n!==this&&!e.contains(this,n)?o.fn.apply(this,arguments):void 0}),o.del=u&&u(r,t);var l=o.del||r;o.proxy=function(e){var t=l.apply(n,[e].concat(e.data));return t===!1&&(e.preventDefault(),e.stopPropagation()),t},o.i=h.length,h.push(o),n.addEventListener(s(o.e),o.proxy,a(o,c))})}function d(e,i,r,l,d){var u=t(e);o(i||"",r,function(t,i){n(e,t,i,l).forEach(function(t){delete f[u][t.i],e.removeEventListener(s(t.e),t.proxy,a(t,d))})})}function u(t){var n,i={originalEvent:t};for(n in t)b.test(n)||void 0===t[n]||(i[n]=t[n]);return e.each(y,function(e,n){i[e]=function(){return this[n]=v,t[e].apply(t,arguments)},i[n]=g}),i}function c(e){if(!("defaultPrevented"in e)){e.defaultPrevented=!1;var t=e.preventDefault;e.preventDefault=function(){this.defaultPrevented=!0,t.call(this)}}}var f=(e.zepto.qsa,{}),p=1,h={},m={mouseenter:"mouseover",mouseleave:"mouseout"};h.click=h.mousedown=h.mouseup=h.mousemove="MouseEvents",e.event={add:l,remove:d},e.proxy=function(n,i){if(e.isFunction(n)){var r=function(){return n.apply(i,arguments)};return r._zid=t(n),r}if("string"==typeof i)return e.proxy(n[i],n);throw new TypeError("expected function")},e.fn.bind=function(e,t){return this.each(function(){l(this,e,t)})},e.fn.unbind=function(e,t){return this.each(function(){d(this,e,t)})},e.fn.one=function(e,t){return this.each(function(n,i){l(this,e,t,null,function(e,t){return function(){var n=e.apply(i,arguments);return d(i,t,e),n}})})};var v=function(){return!0},g=function(){return!1},b=/^([A-Z]|layer[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,n,i){return this.each(function(r,o){l(o,n,i,t,function(n){return function(i){var r,a=e(i.target).closest(t,o).get(0);return a?(r=e.extend(u(i),{currentTarget:a,liveFired:o}),n.apply(a,[r].concat([].slice.call(arguments,1)))):void 0}})})},e.fn.undelegate=function(e,t,n){return this.each(function(){d(this,t,n,e)})},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,i){return!n||e.isFunction(n)?this.bind(t,n||i):this.delegate(n,t,i)},e.fn.off=function(t,n,i){return!n||e.isFunction(n)?this.unbind(t,n||i):this.undelegate(n,t,i)},e.fn.trigger=function(t,n){return("string"==typeof t||e.isPlainObject(t))&&(t=e.Event(t)),c(t),t.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(t)})},e.fn.triggerHandler=function(t,i){var r,o;return this.each(function(a,s){r=u("string"==typeof t?e.Event(t):t),r.data=i,r.target=s,e.each(n(s,t.type||t),function(e,t){return o=t.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),o},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.each(function(){try{this[t]()}catch(e){}}),this}}),e.Event=function(e,t){"string"!=typeof e&&(t=e,e=t.type);var n=document.createEvent(h[e]||"Events"),i=!0;if(t)for(var r in t)"bubbles"==r?i=!!t[r]:n[r]=t[r];return n.initEvent(e,i,!0,null,null,null,null,null,null,null,null,null,null,null,null),n.isDefaultPrevented=function(){return this.defaultPrevented},n}}(Zepto),function(e){function t(t,n,i){var r=e.Event(n);return e(t).trigger(r,i),!r.defaultPrevented}function n(e,n,i,r){return e.global?t(n||b,i,r):void 0}function i(t){t.global&&0===e.active++&&n(t,null,"ajaxStart")}function r(t){t.global&&!--e.active&&n(t,null,"ajaxStop")}function o(e,t){var i=t.context;return t.beforeSend.call(i,e,t)===!1||n(t,i,"ajaxBeforeSend",[e,t])===!1?!1:(n(t,i,"ajaxSend",[e,t]),void 0)}function a(e,t,i){var r=i.context,o="success";i.success.call(r,e,o,t),n(i,r,"ajaxSuccess",[t,i,e]),l(o,t,i)}function s(e,t,i,r){var o=r.context;r.error.call(o,i,t,e),n(r,o,"ajaxError",[i,r,e]),l(t,i,r)}function l(e,t,i){var o=i.context;i.complete.call(o,t,e),n(i,o,"ajaxComplete",[t,i]),r(i)}function d(){}function u(e){return e&&(e=e.split(";",2)[0]),e&&(e==E?"html":e==x?"json":w.test(e)?"script":T.test(e)&&"xml")||"text"}function c(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function f(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=c(t.url,t.data))}function p(t,n,i,r){var o=!e.isFunction(n);return{url:t,data:o?n:void 0,success:o?e.isFunction(i)?i:void 0:n,dataType:o?r||i:i}}function h(t,n,i,r){var o,a=e.isArray(n);e.each(n,function(n,s){o=e.type(s),r&&(n=i?r:r+"["+(a?"":n)+"]"),!r&&a?t.add(s.name,s.value):"array"==o||!i&&"object"==o?h(t,s,i,n):t.add(n,s)})}var m,v,g=0,b=window.document,y=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,w=/^(?:text|application)\/javascript/i,T=/^(?:text|application)\/xml/i,x="application/json",E="text/html",S=/^\s*$/;e.active=0,e.ajaxJSONP=function(t){if(!("type"in t))return e.ajax(t);var n,i="jsonp"+ ++g,r=b.createElement("script"),l=function(){clearTimeout(n),e(r).remove(),delete window[i]},u=function(e){l(),e&&"timeout"!=e||(window[i]=d),s(null,e||"abort",c,t)},c={abort:u};return o(c,t)===!1?(u("abort"),!1):(window[i]=function(e){l(),a(e,c,t)},r.onerror=function(){u("error")},r.src=t.url.replace(/=\?/,"="+i),e("head").append(r),t.timeout>0&&(n=setTimeout(function(){u("timeout")},t.timeout)),c)},e.ajaxSettings={type:"GET",beforeSend:d,success:d,error:d,complete:d,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:x,xml:"application/xml, text/xml",html:E,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(t){var n=e.extend({},t||{});for(m in e.ajaxSettings)void 0===n[m]&&(n[m]=e.ajaxSettings[m]);i(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=""+window.location),f(n),n.cache===!1&&(n.url=c(n.url,"_="+Date.now()));var r=n.dataType,l=/=\?/.test(n.url);if("jsonp"==r||l)return l||(n.url=c(n.url,"callback=?")),e.ajaxJSONP(n);var p,h=n.accepts[r],g={},b=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,y=n.xhr();n.crossDomain||(g["X-Requested-With"]="XMLHttpRequest"),h&&(g.Accept=h,h.indexOf(",")>-1&&(h=h.split(",",2)[0]),y.overrideMimeType&&y.overrideMimeType(h)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&(g["Content-Type"]=n.contentType||"application/x-www-form-urlencoded"),n.headers=e.extend(g,n.headers||{}),y.onreadystatechange=function(){if(4==y.readyState){y.onreadystatechange=d,clearTimeout(p);var t,i=!1;if(y.status>=200&&300>y.status||304==y.status||0==y.status&&"file:"==b){r=r||u(y.getResponseHeader("content-type")),t=y.responseText;try{"script"==r?(1,eval)(t):"xml"==r?t=y.responseXML:"json"==r&&(t=S.test(t)?null:e.parseJSON(t))}catch(o){i=o}i?s(i,"parsererror",y,n):a(t,y,n)}else s(null,y.status?"error":"abort",y,n)}};var w="async"in n?n.async:!0;y.open(n.type,n.url,w);for(v in n.headers)y.setRequestHeader(v,n.headers[v]);return o(y,n)===!1?(y.abort(),!1):(n.timeout>0&&(p=setTimeout(function(){y.onreadystatechange=d,y.abort(),s(null,"timeout",y,n)},n.timeout)),y.send(n.data?n.data:null),y)},e.get=function(){return e.ajax(p.apply(null,arguments))},e.post=function(){var t=p.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=p.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,n,i){if(!this.length)return this;var r,o=this,a=t.split(/\s/),s=p(t,n,i),l=s.success;return a.length>1&&(s.url=a[0],r=a[1]),s.success=function(t){o.html(r?e("<div>").html(t.replace(y,"")).find(r):t),l&&l.apply(o,arguments)},e.ajax(s),this};var _=encodeURIComponent;e.param=function(e,t){var n=[];return n.add=function(e,t){this.push(_(e)+"="+_(t))},h(n,e,t),n.join("&").replace(/%20/g,"+")}}(Zepto),function(e){e.fn.serializeArray=function(){var t,n=[];return e(Array.prototype.slice.call(this.get(0).elements)).each(function(){t=e(this);var i=t.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&n.push({name:t.attr("name"),value:t.val()})}),n},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(e,t){function n(e){return i(e.replace(/([a-z])([A-Z])/,"$1-$2"))}function i(e){return e.toLowerCase()}function r(e){return o?o+e:i(e)}var o,a,s,l,d,u,c,f,p="",h={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},m=window.document,v=m.createElement("div"),g=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,b={};e.each(h,function(e,n){return v.style[e+"TransitionProperty"]!==t?(p="-"+i(e)+"-",o=n,!1):t}),a=p+"transform",b[s=p+"transition-property"]=b[l=p+"transition-duration"]=b[d=p+"transition-timing-function"]=b[u=p+"animation-name"]=b[c=p+"animation-duration"]=b[f=p+"animation-timing-function"]="",e.fx={off:o===t&&v.style.transitionProperty===t,speeds:{_default:400,fast:200,slow:600},cssPrefix:p,transitionEnd:r("TransitionEnd"),animationEnd:r("AnimationEnd")},e.fn.animate=function(t,n,i,r){return e.isPlainObject(n)&&(i=n.easing,r=n.complete,n=n.duration),n&&(n=("number"==typeof n?n:e.fx.speeds[n]||e.fx.speeds._default)/1e3),this.anim(t,n,i,r)},e.fn.anim=function(i,r,o,p){var h,m,v,y={},w="",T=this,x=e.fx.transitionEnd;if(r===t&&(r=.4),e.fx.off&&(r=0),"string"==typeof i)y[u]=i,y[c]=r+"s",y[f]=o||"linear",x=e.fx.animationEnd;else{m=[];for(h in i)g.test(h)?w+=h+"("+i[h]+") ":(y[h]=i[h],m.push(n(h)));w&&(y[a]=w,m.push(a)),r>0&&"object"==typeof i&&(y[s]=m.join(", "),y[l]=r+"s",y[d]=o||"linear")}return v=function(n){if(n!==t){if(n.target!==n.currentTarget)return;e(n.target).unbind(x,v)}e(this).css(b),p&&p.call(this)},r>0&&this.bind(x,v),this.size()&&this.get(0).clientLeft,this.css(y),0>=r&&setTimeout(function(){T.each(function(){v.call(this)})},0),this},v=null}(Zepto),function(e){var t=[],n=function(){},i={defaultPath:"/",before:n,on:n,notfound:n},r={current:null,previous:null,config:function(e){for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return r},add:function(e,n,i){return e&&n&&("function"==typeof n&&(i=n,n=null),t.push({path:e,name:n,fn:i||function(){}})),r},go:function(e){return location.hash=e,r},back:function(e){return r.previous?(history.back(),r.previous=null):e&&(location.hash=e),r}},o=function(){var e=location.hash.slice(1),n=!1,o=r.current;e||(e=i.defaultPath),o&&o!=r.previous&&(r.previous=o),r.current=e;for(var a=0,s=t.length;s>a&&!n;a++){var l=t[a],d=l.path,u=l.name,c=l.fn;if("string"==typeof d)d.toLowerCase()==e.toLowerCase()&&(i.before.call(r,d,u),c.call(r),i.on.call(r,d,u),n=!0);else{var f=e.match(d);f&&(i.before.call(r,d,u,f),c.apply(r,f),i.on.call(r,d,u,f),n=!0)}}return n||i.notfound.call(r),r};r.init=function(){return e.addEventListener("hashchange",o),o()},r.reload=o,e.ruto=r}(window),function(e,t){function n(e,n){i.addType(e,function(o,a,s){var l,d,u,c,f=a,p=(new Date).getTime();if(!o){f={},c=[],u=0;try{for(o=n.length;o=n.key(u++);)r.test(o)&&(d=JSON.parse(n.getItem(o)),d.expires&&p>=d.expires?c.push(o):f[o.replace(r,"")]=d.data);for(;o=c.pop();)n.removeItem(o)}catch(h){}return f}if(o="__amplify__"+o,a===t){if(l=n.getItem(o),d=l?JSON.parse(l):{expires:-1},!(d.expires&&p>=d.expires))return d.data;n.removeItem(o)}else if(null===a)n.removeItem(o);else{d=JSON.stringify({data:a,expires:s.expires?p+s.expires:null});try{n.setItem(o,d)}catch(h){i[e]();try{n.setItem(o,d)}catch(h){throw i.error()}}}return f})}var i=e.store=function(e,t,n){var r=i.type;return n&&n.type&&n.type in i.types&&(r=n.type),i.types[r](e,t,n||{})};i.types={},i.type=null,i.addType=function(e,t){i.type||(i.type=e),i.types[e]=t,i[e]=function(t,n,r){return r=r||{},r.type=e,i(t,n,r)}},i.error=function(){return"amplify.store quota exceeded"};var r=/^__amplify__/;for(var o in{localStorage:1,sessionStorage:1})try{window[o].setItem("__amplify__","x"),window[o].removeItem("__amplify__"),n(o,window[o])}catch(a){}if(!i.types.localStorage&&window.globalStorage)try{n("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===i.type&&(i.type="globalStorage")}catch(a){}(function(){if(!i.types.localStorage){var e=document.createElement("div"),n="amplify";e.style.display="none",document.getElementsByTagName("head")[0].appendChild(e);try{e.addBehavior("#default#userdata"),e.load(n)}catch(r){return e.parentNode.removeChild(e),t}i.addType("userData",function(r,o,a){e.load(n);var s,l,d,u,c,f=o,p=(new Date).getTime();if(!r){for(f={},c=[],u=0;s=e.XMLDocument.documentElement.attributes[u++];)l=JSON.parse(s.value),l.expires&&p>=l.expires?c.push(s.name):f[s.name]=l.data;for(;r=c.pop();)e.removeAttribute(r);return e.save(n),f}if(r=r.replace(/[^\-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-"),r=r.replace(/^-/,"_-"),o===t){if(s=e.getAttribute(r),l=s?JSON.parse(s):{expires:-1},!(l.expires&&p>=l.expires))return l.data;e.removeAttribute(r)}else null===o?e.removeAttribute(r):(d=e.getAttribute(r),l=JSON.stringify({data:o,expires:a.expires?p+a.expires:null}),e.setAttribute(r,l));try{e.save(n)}catch(h){null===d?e.removeAttribute(r):e.setAttribute(r,d),i.userData();try{e.setAttribute(r,l),e.save(n)}catch(h){throw null===d?e.removeAttribute(r):e.setAttribute(r,d),i.error()}}return f})}})(),function(){function e(e){return e===t?t:JSON.parse(JSON.stringify(e))}var n={},r={};i.addType("memory",function(i,o,a){return i?o===t?e(n[i]):(r[i]&&(clearTimeout(r[i]),delete r[i]),null===o?(delete n[i],null):(n[i]=o,a.expires&&(r[i]=setTimeout(function(){delete n[i],delete r[i]},a.expires)),o)):e(n)})}()}(this.amplify=this.amplify||{});var Hogan={};(function(e,t){function n(e,t,n){var i;return t&&"object"==typeof t&&(null!=t[e]?i=t[e]:n&&t.get&&"function"==typeof t.get&&(i=t.get(e))),i}function i(e,t,n,i){function r(){}function o(){}r.prototype=e,o.prototype=e.subs;var a,s=new r;s.subs=new o,s.subsText={},s.ib();for(a in t)s.subs[a]=t[a],s.subsText[a]=i;for(a in n)s.partials[a]=n[a];return s}function r(e){return(null===e||void 0===e?"":e)+""}function o(e){return e=r(e),c.test(e)?e.replace(a,"&amp;").replace(s,"&lt;").replace(l,"&gt;").replace(d,"&#39;").replace(u,"&quot;"):e}e.Template=function(e,t,n,i){e=e||{},this.r=e.code||this.r,this.c=n,this.options=i||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.ib()},e.Template.prototype={r:function(){return""},v:o,t:r,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},ep:function(e,t){var n=this.partials[e],r=t[n.name];if(n.instance&&n.base==r)return n.instance;if("string"==typeof r){if(!this.c)throw Error("No compiler available.");r=this.c.compile(r,this.options)}return r?(this.partials[e].base=r,n.subs&&(void 0===this.activeSub&&(t.stackText=this.text),r=i(r,n.subs,n.partials,t.stackText||this.text)),this.partials[e].instance=r,r):null},rp:function(e,t,n,i){var r=this.ep(e,n);return r?r.ri(t,n,i):""},rs:function(e,t,n){var i=e[e.length-1];if(!f(i))return n(e,t,this),void 0;for(var r=0;i.length>r;r++)e.push(i[r]),n(e,t,this),e.pop()},s:function(e,t,n,i,r,o,a){var s;return f(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ms(e,t,n,i,r,o,a)),s=!!e,!i&&s&&t&&t.push("object"==typeof e?e:t[t.length-1]),s)},d:function(e,t,i,r){var o,a=e.split("."),s=this.f(a[0],t,i,r),l=this.options.modelGet,d=null;if("."===e&&f(t[t.length-2]))s=t[t.length-1];else for(var u=1;a.length>u;u++)o=n(a[u],s,l),null!=o?(d=s,s=o):s="";return r&&!s?!1:(r||"function"!=typeof s||(t.push(d),s=this.mv(s,t,i),t.pop()),s)},f:function(e,t,i,r){for(var o=!1,a=null,s=!1,l=this.options.modelGet,d=t.length-1;d>=0;d--)if(a=t[d],o=n(e,a,l),null!=o){s=!0;break}return s?(r||"function"!=typeof o||(o=this.mv(o,t,i)),o):r?!1:""},ls:function(e,t,n,i,o){var a=this.options.delimiters;return this.options.delimiters=o,this.b(this.ct(r(e.call(t,i)),t,n)),this.options.delimiters=a,!1},ct:function(e,t,n){if(this.options.disableLambda)throw Error("Lambda features disabled.");return this.c.compile(e,this.options).render(t,n)},b:t?function(e){this.buf.push(e)}:function(e){this.buf+=e},fl:t?function(){var e=this.buf.join("");return this.buf=[],e}:function(){var e=this.buf;return this.buf="",e
},ib:function(){this.buf=t?[]:""},ms:function(e,t,n,i,r,o,a){var s,l=t[t.length-1],d=e.call(l);return"function"==typeof d?i?!0:(s=this.activeSub&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(d,l,n,s.substring(r,o),a)):d},mv:function(e,t,n){var i=t[t.length-1],o=e.call(i);return"function"==typeof o?this.ct(r(o.call(i)),i,n):o},sub:function(e,t,n,i){var r=this.subs[e];r&&(this.activeSub=e,r(t,n,this,i),this.activeSub=!1)}};var a=/&/g,s=/</g,l=/>/g,d=/\'/g,u=/\"/g,c=/[&<>\"\']/,f=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}})("undefined"!=typeof exports?exports:Hogan),function(e,t){"function"==typeof define&&define.amd?define("tappable",[],function(){return t(e,window.document),e.tappable}):t(e,window.document)}(this,function(e,t){var n=(Math.abs,function(){}),i={noScroll:!1,activeClass:"tappable-active",onTap:n,onStart:n,onMove:n,onMoveOut:n,onMoveIn:n,onEnd:n,onCancel:n,allowClick:!1,boundMargin:50,noScrollDelay:0,activeClassDelay:0,inactiveClassDelay:0},r="ontouchend"in document,o={start:r?"touchstart":"mousedown",move:r?"touchmove":"mousemove",end:r?"touchend":"mouseup"},a=function(e,n){var i=t.elementFromPoint(e,n);return 3==i.nodeType&&(i=i.parentNode),i},s=function(e){var t=e.target;if(t)return t;var n=e.targetTouches[0];return a(n.clientX,n.clientY)},l=function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},d=function(e,t){return t?e.classList?(e.classList.add(t),void 0):(l(e.className).indexOf(t)>-1||(e.className=l(e.className+" "+t)),void 0):void 0},u=function(e,t){return t?e.classList?(e.classList.remove(t),void 0):(e.className=e.className.replace(RegExp("(^|\\s)"+t+"(?:\\s|$)"),"$1"),void 0):void 0},c=function(e,n){var i=t.documentElement,r=i.matchesSelector||i.mozMatchesSelector||i.webkitMatchesSelector||i.oMatchesSelector||i.msMatchesSelector;return r.call(e,n)},f=function(e,t){var n=!1;do n=c(e,t);while(!n&&(e=e.parentNode)&&e.ownerDocument);return n?e:!1};e.tappable=function(e,n){"function"==typeof n&&(n={onTap:n});var r={};for(var l in i)r[l]=n[l]||i[l];var c,p,h,m,v,g,b,y,w=r.containerElement||t.body,T=!1,x=!1,E=r.activeClass,S=r.activeClassDelay,_=r.inactiveClassDelay,k=r.noScroll,C=r.noScrollDelay,$=r.boundMargin;w.addEventListener(o.start,function(t){var n=f(s(t),e);if(n){if(S?(clearTimeout(g),g=setTimeout(function(){d(n,E)},S)):d(n,E),_&&n==p&&clearTimeout(b),h=t.clientX,m=t.clientY,!h||!m){var i=t.targetTouches[0];h=i.clientX,m=i.clientY}c=n,T=!1,x=!1,v=k?n.getBoundingClientRect():null,C&&(clearTimeout(y),k=!1,y=setTimeout(function(){k=!0},C)),r.onStart.call(w,t,n)}},!1),w.addEventListener(o.move,function(e){if(c){k?e.preventDefault():clearTimeout(g);var t=e.target,n=e.clientX,i=e.clientY;if(!t||!n||!i){var o=e.changedTouches[0];n||(n=o.clientX),i||(i=o.clientY),t||(t=a(n,i))}k?n>v.left-$&&v.right+$>n&&i>v.top-$&&v.bottom+$>i?(x=!1,d(c,E),r.onMoveIn.call(w,e,t)):(x=!0,u(c,E),r.onMoveOut.call(w,e,t)):!T&&Math.abs(i-m)>10&&(T=!0,u(c,E),r.onCancel.call(t,e)),r.onMove.call(w,e,t)}},!1),w.addEventListener(o.end,function(e){if(c){if(clearTimeout(g),_){S&&!T&&d(c,E);var t=c;b=setTimeout(function(){u(t,E)},_)}else u(c,E);r.onEnd.call(w,e,c);var n=3==e.which||2==e.button;T||x||n||r.onTap.call(w,e,c),p=c,c=null,setTimeout(function(){h=m=null},400)}},!1),w.addEventListener("touchcancel",function(e){c&&(u(c,E),c=h=m=null,r.onCancel.call(w,e))},!1),r.allowClick||w.addEventListener("click",function(t){var n=f(t.target,e);n?t.preventDefault():h&&m&&25>Math.abs(t.clientX-h)&&25>Math.abs(t.clientY-m)&&(t.stopPropagation(),t.preventDefault())},!1)}});var TWEEN=TWEEN||function(){var e=[];return{REVISION:"10",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)},update:function(t){if(0===e.length)return!1;var n=0,i=e.length;for(t=void 0!==t?t:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();i>n;)e[n].update(t)?n++:(e.splice(n,1),i--);return!0}}}();if(TWEEN.Tween=function(e){var t=e,n={},i={},r={},o=1e3,a=0,s=0,l=null,d=TWEEN.Easing.Linear.None,u=TWEEN.Interpolation.Linear,c=[],f=null,p=!1,h=null,m=null;for(var v in e)n[v]=parseFloat(e[v],10);this.to=function(e,t){return void 0!==t&&(o=t),i=e,this},this.start=function(e){TWEEN.add(this),p=!1,l=void 0!==e?e:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),l+=s;for(var o in i){if(i[o]instanceof Array){if(0===i[o].length)continue;i[o]=[t[o]].concat(i[o])}n[o]=t[o],n[o]instanceof Array==!1&&(n[o]*=1),r[o]=n[o]||0}return this},this.stop=function(){return TWEEN.remove(this),this},this.delay=function(e){return s=e,this},this.repeat=function(e){return a=e,this},this.easing=function(e){return d=e,this},this.interpolation=function(e){return u=e,this},this.chain=function(){return c=arguments,this},this.onStart=function(e){return f=e,this},this.onUpdate=function(e){return h=e,this},this.onComplete=function(e){return m=e,this},this.update=function(e){if(l>e)return!0;p===!1&&(null!==f&&f.call(t),p=!0);var v=(e-l)/o;v=v>1?1:v;var g=d(v);for(var b in i){var y=n[b]||0,w=i[b];w instanceof Array?t[b]=u(w,g):("string"==typeof w&&(w=y+parseFloat(w,10)),t[b]=y+(w-y)*g)}if(null!==h&&h.call(t,g),1==v){if(a>0){isFinite(a)&&a--;for(var b in r)"string"==typeof i[b]&&(r[b]=r[b]+parseFloat(i[b],10)),n[b]=r[b];return l=e+s,!0}null!==m&&m.call(t);for(var T=0,x=c.length;x>T;T++)c[T].start(e);return!1}return!0}},TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return 1>(e*=2)?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:1>(e*=2)?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return 1>(e*=2)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/i)))},Out:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*2*Math.PI/i)+1)},InOut:function(e){var t,n=.1,i=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=i/4):t=i*Math.asin(1/n)/(2*Math.PI),1>(e*=2)?-.5*n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/i):.5*n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*2*Math.PI/i)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return 1>(e*=2)?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*TWEEN.Easing.Bounce.In(2*e):.5*TWEEN.Easing.Bounce.Out(2*e-1)+.5}}},TWEEN.Interpolation={Linear:function(e,t){var n=e.length-1,i=n*t,r=Math.floor(i),o=TWEEN.Interpolation.Utils.Linear;return 0>t?o(e[0],e[1],i):t>1?o(e[n],e[n-1],n-i):o(e[r],e[r+1>n?n:r+1],i-r)},Bezier:function(e,t){var n,i=0,r=e.length-1,o=Math.pow,a=TWEEN.Interpolation.Utils.Bernstein;for(n=0;r>=n;n++)i+=o(1-t,r-n)*o(t,n)*e[n]*a(r,n);return i},CatmullRom:function(e,t){var n=e.length-1,i=n*t,r=Math.floor(i),o=TWEEN.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(0>t&&(r=Math.floor(i=n*(1+t))),o(e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n],i-r)):0>t?e[0]-(o(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[n]-(o(e[n],e[n],e[n-1],e[n-1],i-n)-e[n]):o(e[r?r-1:0],e[r],e[r+1>n?n:r+1],e[r+2>n?n:r+2],i-r)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=TWEEN.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n,i=1;if(e[t])return e[t];for(n=t;n>1;n--)i*=n;return e[t]=i}}(),CatmullRom:function(e,t,n,i,r){var o=.5*(n-e),a=.5*(i-t),s=r*r,l=r*s;return(2*t-2*n+o+a)*l+(-3*t+3*n-2*o-a)*s+o*r+t}}},function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;t.length>n&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),r=window.setTimeout(function(){t(n+i)},i);return e=n+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),dddns="undefined"==typeof dddns?{}:dddns,dddns.lib=1,dddns="undefined"==typeof dddns?{}:dddns,dddns.TF=function(e){TEMPLATES={"add-feed":new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div class="header">    <label for="feed">Feed url</label>    <input id="add-feed" placeholder="feed to add" type="text" autocorrect="off" autocapitalize="off" autofocus="autofocus"></div>'),i.fl()},partials:{},subs:{}}),article:new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div class="post-content">    <header>        <h1>            <a id="full_article" href="'),i.b(i.v(i.f("link",e,t,0))),i.b('" target="_blank">'),i.b(i.t(i.f("title",e,t,0))),i.b('<br>            </a>        </h1>        <p class="metadata">            <span class="inline-block">'),i.b(i.v(i.f("date",e,t,0))),i.b(" "),i.s(i.f("author",e,t,1),e,t,0,246,259,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("by "),n.b(n.v(n.f("author",e,t,0)))}),e.pop()),i.b(' </span>             <span class="inline-block">'),i.b(i.v(i.f("time_ago",e,t,0))),i.s(i.f("comments_count",e,t,1),e,t,0,349,391,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b(" &middot; "),n.b(n.v(n.f("comments_count",e,t,0))),n.b(" "),n.b(n.v(n.f("i_comment",e,t,0)))}),e.pop()),i.b('</span>        </p>    </header>    <section class="grouped-tableview">        '),i.b(i.t(i.f("content",e,t,0))),i.b("    </section></div>"),i.fl()},partials:{},subs:{}}),"feed-partial":new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.s(i.f("icon",e,t,1),e,t,0,9,51,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<img class="fav" src="'),n.b(n.v(n.f("icon",e,t,0))),n.b(n.v(n.f("id",e,t,0))),n.b('.ico">')}),e.pop()),i.s(i.f("icon",e,t,1),e,t,1,0,0,"")||(i.b('<div class="number">'),i.b(i.v(i.f("i",e,t,0))),i.b(".</div>")),i.b('<div class="feed">    <b>'),i.b(i.t(i.f("title",e,t,0))),i.b("</b>    "),i.s(i.f("updated",e,t,1),e,t,0,166,274,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('        <span class="metadata">            <span class="inline-block">'),n.b(n.v(n.f("updated",e,t,0))),n.b("</span>         </span>    ")}),e.pop()),i.b("</div>"),i.fl()},partials:{},subs:{}}),"feeds-load":new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.s(i.f("loading",e,t,1),e,t,0,12,53,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<div class="loader">Loading&hellip;</div>')}),e.pop()),i.s(i.f("load_error",e,t,1),e,t,0,80,130,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<div class="load-error">Couldn\'t load feeds.</div>')}),e.pop()),i.fl()},partials:{},subs:{}}),feeds:new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.b('<li id="feed-'),i.b(i.v(i.f("id",e,t,0))),i.b('" data-index="'),i.b(i.v(i.f("i",e,t,0))),i.b('" class="'),i.b(i.v(i.f("type",e,t,0))),i.b('">    '),i.s(i.f("urlid",e,t,1),e,t,0,71,111,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<a href="#/feed/'),n.b(n.v(n.f("urlid",e,t,0))),n.b('" class="">    ')}),e.pop()),i.b("    "),i.s(i.f("urlid",e,t,1),e,t,1,0,0,"")||(i.b('<a href="#/feed/'),i.b(i.v(i.f("id",e,t,0))),i.b('" class="">    ')),i.b(i.rp("<feed_partial0",e,t,"")),i.b("</a>"),i.s(i.f("unread",e,t,1),e,t,0,214,255,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<span class="count">'),n.b(n.v(n.f("unread",e,t,0))),n.b("</span></a>")}),e.pop()),i.b("</li>"),i.fl()},partials:{"<feed_partial0":{name:"feed_partial",partials:{},subs:{}}},subs:{}}),headline:new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.b('<li id="article-'),i.b(i.v(i.f("id",e,t,0))),i.b('" data-index="'),i.b(i.v(i.f("i",e,t,0))),i.b('" class="'),i.b(i.v(i.f("type",e,t,0))),i.b('"><a href="#/article/'),i.b(i.v(i.f("id",e,t,0))),i.b("/"),i.b(i.v(i.f("i",e,t,0))),i.b('" class=""><div class="number">'),i.b(i.v(i.f("i",e,t,0))),i.b('.</div><div class="feed"><b>'),i.b(i.t(i.f("title",e,t,0))),i.b("</b></div></a></li>"),i.fl()},partials:{},subs:{}}),login:new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div class="post-content">    <section class="grouped-tableview">            <form method="post">            <table>                <tbody>                    <tr>                        <td><label for="username">Username</td>                        <td><input id="username" class="" placeholder="username" type="text" autocorrect="off" autocapitalize="off" autofocus="autofocus"></td>                    </tr>                    <tr>                        <td><label for="password">Password</label></td>                        <td><input id="password" class="" placeholder="password" type="password"></td>                    </tr>                    <tr>                        <td><input type="button" class="" value="Login" id="login"></td>                    </tr>                    <tr>                        <td colspan="2"><span class="view hidden login-error"></span>                    </tr>                </tbody>            </table>            </form>    </section></div>'),i.fl()},partials:{},subs:{}}),"remove-feed-inline":new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.b('<span class="q">    '),i.b(i.rp("<feed_partial0",e,t,"")),i.b('    <span class="question"><a class="button delete" href="#/">Delete</a> this feed? <a class="cancel" href="#/">cancel</a> </span></span>'),i.fl()},partials:{"<feed_partial0":{name:"feed_partial",partials:{},subs:{}}},subs:{}}),"remove-feed":new e({code:function(e,t,n){var i=this;return i.b(n=n||""),i.b('<span>    <span class="question"><a class="button delete" href="#/">Delete</a> <a class="cancel" href="#/">cancel</a> '),i.b(i.v(i.f("title",e,t,0))),i.b(" feed? </span></span>"),i.fl()},partials:{},subs:{}})}},dddns="undefined"==typeof dddns?{}:dddns,dddns.ddd=function(e){function t(e){var t=document.body.scrollTop,n=t+window.innerHeight,i=e.offsetTop,r=i+e.offsetHeight,o=n>=r&&i>=t;return o}var n=e.document;n.body,"undefined"==typeof TEMPLATES&&dddns.TF(Hogan.Template);var i={},r={pollRetries:0,pub:function(e,t){var n=i[e];if(n)for(var r=0,o=n.length;o>r;r++)n[r].call(this,t)},sub:function(e,t){i[e]||(i[e]=[]),i[e].push(t)},prevView:null,currentView:null,hideAllViews:function(){for(var e=n.querySelectorAll(".view"),t=0,i=e.length;i>t;t++)$(e[t]).addClass("hidden")},tmpl:function(e,t){var n=TEMPLATES[e];if(n)return t?n.render(t):n},formatDate:function(e,t){var n=new Date(1e3*e),i=""+n.getFullYear()+"/"+r.pad(n.getMonth()+1)+"/"+r.pad(n.getDate());return t&&(i+=" "+r.pad(n.getHours())+":"+r.pad(n.getMinutes())),i},pad:function(e){return 10>e?"0"+e:e},remove:function(e,t){if(0===t)return e.slice(1);if(t==e.length-1)return e.slice(0,e.length-1);var n=e.slice(0,t),i=e.slice(t+1,e.length);return n.push.apply(n,i),n},pollServer:function(){void 0!==r.config.refresh_every&&r.config.refresh_every&&(0>=r.config.refresh_every||(r.pollTimer&&clearTimeout(r.pollTimer),r.pollTimer=setTimeout(r.pollRefresh,6e4*r.config.refresh_every),r.pollRetries=0))},pollServerError:function(){r.pollRetries=r.pollRetries+1;var e=6e4*r.config.refresh_every;r.pollTimer=setTimeout(r.pollRefresh,Math.pow(2,r.pollRetries)*e)},pollRefresh:function(){var e=new Date,t="Poll at "+e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();console.log(t),r.feeds.reload(!0)}},o=2e4,a=function(e,t,n,i){var r=function(e){e.session_id&&amplify.store("feeds-sid",e.session_id),n(e)},o=function(e){i(e)};loginMsg={op:"login",user:e,password:t},s(loginMsg,r,o)},s=function(e,t,n){t||(t=function(){}),n||(n=function(){});var i=function(e){var i=e;if(console.log("<- ",i),i&&!i.error){if(i.content){var o=i.content.error;if("NOT_LOGGED_IN"===o){if(/login/i.test(location.href))return n(i.content);amplify.store("feeds-sid",null),ruto.go("/login"),r.login.render()}}t(i.content)}else n(i)},a=function(e){console.log("*- ",e),n(JSON.parse(JSON.stringify(e)))},s=amplify.store("feeds-sid");s&&(e.sid=s),console.log("->",e),$.ajax({type:"POST",url:r.config.api+"api/",contentType:"application/json",dataType:"json",timeout:o,data:JSON.stringify(e),success:i,error:a})},l={feeds:function(e,t,n){s(e,t,n)},headlines:function(e,t,n){s(e,t,n)},login:function(e,t,n,i){a(e,t,n,i)},updateArticle:function(e,t,n){e.op="updateArticle",s(e,t,n)},catchupFeed:function(e,t,n){s(e,t,n)},subscribeToFeed:function(e,t,n){s(e,t,n)},unsubscribeFeed:function(e,t,n){s(e,t,n)},getConfig:function(e,t,n){s(e,t,n)}},d=r.tmpl,u="Mac";amplify.store.sessionStorage&&"function"==typeof amplify.store.sessionStorage||(amplify.store.sessionStorage=amplify.store.memory);var c=n.querySelector("#view-home .scroll"),f=c.querySelector("section"),p=!1,h=!1,m={};r.feeds={skip:0,skipFeeds:0,feedsRemoved:{},markupFeed:function(e){e.type=e.unread>0?"unread":"read",""===e.title&&(e.title="&nbsp;"),0>e.id&&(-1===e.id?e.urlid="starred":-2===e.id?e.urlid="published":-3===e.id?e.urlid="fresh":-4===e.id?e.urlid="all":-6===e.id&&(e.urlid="recent"));var t=d("feeds"),n=d("feed-partial"),i=e.has_icon&&r.config.iconPath;i&&(e.icon=r.config.iconPath);var o=t.render(e,{feed_partial:n});return i&&delete e.icon,o},markupHeadline:function(e){return e.url="#/article/"+e.id,e.type=e.unread>0?"unread":"read",d("headline",e)},markupFeeds:function(e,t){var n="";t||(t=1);var i=r.feeds.markupFeed;return e.forEach(function(e){e.i=t++,n+=i(e)}),n},markupHeadlines:function(e,t){var n="";t||(t=1);var i=r.feeds.markupHeadline;return e.forEach(function(e){e.i=t++,n+=i(e)}),n},feedsAndMore:function(e,t){var n=r.feeds.markupFeeds(e,t);if(n+=e.length>=r.config.FEED_LIMIT?'<li><a class="more-link">More&hellip;<span class="loader"></span></a></li>':"",e.length>=r.config.FEED_LIMIT){var i=r.feeds.skipFeeds;i||(i=0),r.feeds.skipFeeds=i+r.config.FEED_LIMIT}return n},render:function(e){if(!p){e||(e={});var t=amplify.store("ddd-cached"),n=d("feeds-load"),i=function(e){var t=e.slice(),n='<ul class="tableview tableview-links" id="feedslist">'+r.feeds.feedsAndMore(t)+"</ul>";f.innerHTML=n,r.feed.showSelection(),r.pub("onRenderNews")};if(t){var o=amplify.store("feeds");amplify.store("feeds-by-id");var a=e.delay;a?(p=!0,f.innerHTML=n.render({loading:!0}),setTimeout(function(){p=!1,i(o)},a)):i(o)}else{p=!0,f.innerHTML=n.render({loading:!0});var s=function(){f.innerHTML=n.render({load_error:!0}),r.pub("logAPIError","news")},u=amplify.store("view-mode");msg={op:"getFeeds",cat_id:"-3",unread_only:u?"true":"false"},l.feeds(msg,function(e){if(feedsRemoved={},p=!1,!e||e.error)return s(),void 0;byId={};for(var t=0,n=e.length;n>t;t++){var o=e[t];o.index=t,byId[o.id]=o}amplify.store("feeds",e),amplify.store("feeds-by-id",byId),amplify.store("ddd-cached",!0,{expires:6e5}),i(e),r.pollServer()},function(){p=!1,s(),r.pollServerError()})}}},settings:function(){r.feeds.render({delay:300})},moreFeeds:function(e){$(e).addClass("loading");var t=function(){var t=d("feeds-load");$(e).replaceWith(t.render({load_error:!0})),r.pub("logAPIError","news")},n=amplify.store("view-mode");msg={op:"getFeeds",cat_id:"-3",unread_only:n?"true":"false",limit:""+r.config.FEED_LIMIT,offset:""+r.feeds.skipFeeds},l.feeds(msg,function(n){p=!1,$(e).removeClass("loading");var i=e.parentNode;if(i){if(i.parentNode&&i.parentNode.removeChild(i),!n||n.error)return t(),void 0;var o=amplify.store("feeds"),a=amplify.store("feeds-by-id");o&&o.push.apply(o,n);for(var s=0,l=n.length;l>s;s++){var d=n[s];d.index=s,a[d.id]=d}amplify.store("feeds",o),amplify.store("feeds-by-id",a),amplify.store("ddd-cached",!0,{expires:6e5});var u=r.feeds.feedsAndMore(n,r.feeds.skipFeeds+1);$("#feedslist").append(u),r.feeds.skipFeeds+=r.config.FEED_LIMIT}},function(){p=!1,t()})},more:function(e){console.log("more target is",e),$(e).addClass("loading");var t=r.feeds.currentID;if(t){var n=amplify.store("view-mode");msg={op:"getHeadlines",feed_id:""+t,show_content:"true",view_mode:n?"unread":"",skip:""+r.feeds.skip,limit:""+r.config.ARTICLE_LIMIT};var i=amplify.store("feeds-by-id");i[t],l.headlines(msg,function(n){if(r.feeds.currentID==t){$(e).removeClass("loading");var i=e.parentNode;if(i&&(i.parentNode&&i.parentNode.removeChild(i),n)){var o=n.slice();r.feed.currentHeadlines&&r.feed.currentHeadlines.push.apply(r.feed.currentHeadlines,o);var a=r.feeds.markupHeadlines(o,r.feeds.skip+1);a+=o.length>=r.config.ARTICLE_LIMIT?'<li><a class="more-link">More&hellip;<span class="loader"></span></a></li>':"</ul>",$("#dddlist").append(a),r.feeds.skip+=r.config.ARTICLE_LIMIT}}},function(){})}},reload:function(e){e&&(amplify.store("ddd-cached",null),amplify.store("feeds",null),amplify.store("feeds-by-id",null),r.feeds.render())},markAllRead:function(){var e=r.getSelFeed();if(!e)return"article"===r.currentView&&ruto.go("/"),void 0;var t=e.id;if(!(0>t)){msg={op:"catchupFeed",feed_id:""+t},l.catchupFeed(msg,function(){},function(){});var n=amplify.store("view-mode");n&&(r.feed.currentHeadlines=[]),e.unread=0,r.feed.markFeedRead(e),n&&"home"!==r.currentView&&ruto.go("/"),r.feed.showSelection()}},escapePressed:function(){r.feeds.removeFeedsInline(!0)},removeFeedsInline:function(e){var t=r.feeds.feedToDelete;if(t){var n=$("#feed-"+t.id),i=r.feeds.markupFeed(t);return r.pub("onDialogDone"),e?($(n).replaceWith(i),void 0):(r.feeds.removeFeeds(!1),void 0)}},removeFeeds:function(e){if(e)return $("#view-home h1").html("Feeds"),void 0;var t=r.feeds.feedToDelete;if(t){var n={op:"unsubscribeFeed",feed_id:""+t.id};l.unsubscribeFeed(n,function(e){var n="Feed removed",i="good";"error"in e?(n="Feed not found",i="bad"):r.feeds.removeFromStoreAndUi(t),$(".msg").attr("class","msg "+i).html(n).show(),$("#view-home h1").html("Feeds"),setTimeout(function(){$(".msg").hide()},3e3)},function(e){console.log("unsub err",e)})}},removeFeedInline:function(){if("home"===r.currentView){var e=r.getSel(),t=$(e.siz)[e.sel],n=r.getSelFeed();n.i=n.index+1,r.feeds.feedToDelete=n,$(t).find("a");var i=d("remove-feed-inline"),o=d("feed-partial"),a=i.render(n,{feed_partial:o});$(t).html(a),r.pub("onDialog")}},removeFeed:function(){if("home"===r.currentView){var e=r.getSel();$(e.siz)[e.sel];var t=r.getSelFeed();r.feeds.feedToDelete=t;var n=d("remove-feed");$("#view-home h1").html(n.render({id:t.id,title:t.title}))}},addFeed:function(){var e=d("add-feed");$("#view-home h1").html(e.render({}))},addFeedClicked:function(e){if(e)return $("#view-home h1").html("Feeds"),void 0;var t=$("#add-feed").val();0!==t.length&&(msg={op:"subscribeToFeed",feed_url:t},l.subscribeToFeed(msg,function(e){var t="Feed added",n="bad",i=e.status;if(i){var r=i.code,o=i.message;0===r?(t="Feed already exists",n="good"):1==r?(t="Feed added",n="good"):2==r?t="Invalid URL. "+o:3==r?t="Invalid URL. "+o:4==r?t="Invalid URL. "+o:5==r&&(t="Invalid URL. "+o)}$(".msg").addClass(n).html(t).show(),"good"===n&&($("#view-home h1").html("Feeds"),setTimeout(function(){$(".msg").hide()},3e3))},function(e){console.log("in sub e is",e),$(".msg").addClass("bad").html("Error adding feed ").show()}))},storeAgain:function(e){for(var t=amplify.store("feeds"),n=0,i=t.length;i>n;n++)if(t[n].id===e.id){t[n]=e;break}amplify.store("feeds",t);var r=amplify.store("feeds-by-id");r[e.id]=e,amplify.store("feeds-by-id",r)},cmd_toggleUnread:function(){if(amplify.store("view-mode",!amplify.store("view-mode")),"feed"===r.currentView){r.feed.currentHeadlines=null;var e=amplify.store("feeds-by-id");r.feed.render(r.feeds.currentID,e[r.feeds.currentID])}r.feeds.reload(!0),r.feeds.skipFeeds=0,r.feeds.render()},getConfig:function(){msg={op:"getConfig"},l.getConfig(msg,function(e){for(var t in e)e.hasOwnProperty(t)&&(r.config[t]=e[t]);"icons_url"in r.config&&(r.config.iconPath=r.config.api+r.config.icons_url+"/",r.feeds.render())},function(){})},removeFromStoreAndUi:function(e){for(var t=amplify.store("feeds"),n=0,i=0,o=t.length;o>i;i++)if(t[i].id===e.id){n=i;break}t=r.remove(t,n),amplify.store("feeds",t);var a=amplify.store("feeds-by-id");delete a[e.id],amplify.store("feeds-by-id",a);var s=$("#feed-"+e.id);s.remove()}},r.feed={currentID:null,currentHeadlines:null,render:function(e,t){if(e){var n=parseInt(e,10);if(r.feeds.currentID===n&&null!==r.feed.currentHeadlines)return r.feed.showSelection(),void 0;if(!h){r.feeds.currentID=n,r.feeds.skip=0;var i=t;i||(i=amplify.store("feeds-by-id")[n]),i&&$("#view-feed h1").html(i.title);var o=amplify.store("view-mode");h=!0,tmpl1=d("feeds-load"),$("#view-feed .scroll").html(tmpl1.render({loading:!0})),msg={op:"getHeadlines",feed_id:""+n,show_content:"true",view_mode:o?"unread":"",limit:""+r.config.ARTICLE_LIMIT},l.headlines(msg,function(e){h=!1,r.feeds.currentID==n&&(r.feed.renderHeadlines(e,n),r.feed.showSelection())},function(){h=!1})}}},showSelection:function(e){var t=r.getSel(e);void 0!==t&&(items=$(t.siz),t.sel>=items.length&&t.sel>=items.length&&(t.sel=items.length-1,0>t.sel&&(t.sel=0)),$(items[t.sel]).addClass("sel"))},renderHeadlines:function(e){if(e){var t=e.slice();d("feeds-load"),r.feed.currentHeadlines=t;var n='<ul class="tableview tableview-links" id="dddlist">'+r.feeds.markupHeadlines(t)+(t.length>=r.config.ARTICLE_LIMIT?'<li><a class="more-link">More&hellip;<span class="loader"></span></a></li>':"")+"</ul>";if(t.length>=r.config.ARTICLE_LIMIT){var i=r.feeds.skip;i||(i=0),r.feeds.skip=i+r.config.ARTICLE_LIMIT}$("#view-feed .scroll").html(n),r.pub("adjustCommentsSection"),r.pub("onRenderComments")}},markRead:function(e,t){if(e&&e.unread){e.unread=!1,msg={article_ids:""+e.id,mode:"0",field:"2"},l.updateArticle(msg,function(){},function(){});var n=amplify.store("view-mode");n&&(r.feed.currentHeadlines=r.remove(r.feed.currentHeadlines,t)),r.feed.renderHeadlines(r.feed.currentHeadlines,r.feeds.currentID);var i=amplify.store("feeds-by-id"),o=i[r.feeds.currentID];o.unread=o.unread-1,0>=o.unread&&amplify.store("view-mode")?(r.feeds.removeFromStoreAndUi(o),r.feeds.feedsRemoved[o.id]=o):(r.feed.replaceFeedUI(o),r.feeds.storeAgain(o))}},markFeedRead:function(e){e.type="read";var t=amplify.store("view-mode");if(t&&0>=e.unread)r.feeds.removeFromStoreAndUi(e),r.feeds.feedsRemoved[e.id]=e;else{var n=$("#feed-"+e.id);if(0===n.length)return;$(n[0]).find(".count").text(e.unread)}if(!t){for(var i=0,o=r.feed.currentHeadlines.length;o>i;i++){var a=r.feed.currentHeadlines[i];a.unread=!1}$("#view-feed .unread").attr("class","read"),r.feed.replaceFeedUI(e)}},addArticleToUI:function(e,t){if(e&&r.feeds.currentID==e.feed_id){var n=r.feed.currentHeadlines,i=amplify.store("view-mode");i&&n.splice(e.i-1,0,e),r.feed.renderHeadlines(n,e.feed_id),r.feed.replaceFeedUI(t)}},replaceFeedUI:function(e){e.i=e.index+1;var t=r.feeds.markupFeed(e);$("#feed-"+e.id).replaceWith(t)}},r.login={render:function(){var e=amplify.store("feeds-sid");if(e)return r.feeds.getConfig(),r.feeds.render(),r.pollRefresh(),ruto.go("/"),void 0;ruto.go("/login");var t=d("login");$("#view-login .scroll").html(t.render({}))},doLogin:function(){var e=$("#username").val(),t=$("#password").val();l.login(e,t,function(){$("#view-login .scroll").empty(),ruto.go("/"),r.pollRefresh(),$("#view-home .scroll").focus()},function(e){console.log("login failed",e),$(".login-error").html("Login failed"),$(".login-error").removeClass("hidden")})}},r.article={currentID:null,currentArticle:null,render:function(e,t){if(e){r.article.currentID=e;var n=r.feed.currentHeadlines;if(n){var i=n[t];if(i){r.article.currentArticle=i;var o=amplify.store("feeds-by-id")[r.feeds.currentID];$("#view-article h1").html(o.title),r.feed.markRead(i,t),i.hasContent=!0,i.updated&&(i.date=r.formatDate(i.updated,!0)),back="#/feed/"+i.feed_id,$("#view-article .header-back-button").attr("href",back);var a=d("article");$("#view-article .scroll").html(a.render(i))}}}},cmd_next:function(e){"article"===r.currentView&&console.log("article.cmd_next dir=",e,r.currentView)},cmd_markUnread:function(){if(console.log("mark unread"),"home"!==r.currentView){var e=r.article.currentArticle;if("feed"===r.currentView){var t=r.getSel();e=r.feed.currentHeadlines[t.sel]}if(e&&!e.unread){e.unread=!0,msg={article_ids:""+e.id,mode:"1",field:"2"},l.updateArticle(msg,function(){},function(){});var n=amplify.store("feeds-by-id")[e.feed_id];if(n)return n.unread=n.unread+1,r.feeds.storeAgain(n),r.feed.addArticleToUI(e,n),r.feed.renderHeadlines(r.feed.currentHeadlines,r.feeds.currentID),"feed"===r.currentView&&r.cmd_move_sel(1),void 0;if(n=r.feeds.feedsRemoved[e.feed_id]){var i=amplify.store("feeds-by-id");n.unread=1;var o=amplify.store("feeds");o.splice(n.index,0,n),amplify.store("feeds",o),delete r.feeds.feedsRemoved[e.feed_id],i[e.feed_id]=n,amplify.store("feeds-by-id",i),r.feed.addArticleToUI(e,n),r.feeds.render()}}}}},r.resetSelections=function(){return m={feeds:{sel:0,name:"feeds",siz:"#feedslist li"},feed:{sel:0,name:"feed",siz:"#dddlist li"},article:{sel:0,name:"article",siz:"#dddlist li"}}},r.init=function(){var e=amplify.store("view-mode");void 0===e&&amplify.store("view-mode",!0),r.login.render(),r.resetSelections(),ruto.init();var t=navigator.userAgent;u=-1!=t.indexOf("Mac")?"Mac":-1!=t.indexOf("Linux")?"Linux":"Windows"},r.cmd_enter=function(){var e=r.getSel();if(void 0!==e){if("article"==r.currentView)return r.cmd_open(),void 0;if(items=$(e.siz),items&&!(0>e.sel||e.sel>=items.length)){var t=$(items[e.sel]).find("a");if(t&&0!==t.length){if("home"===r.currentView){var n=t[0].href;e.cur!=n&&(r.getSel("feed").sel=0),e.cur=n}$(t[0]).click()}}}},r.cmd_goUp=function(){if("home"!==r.currentView){if("article"===r.currentView){var e=amplify.store("view-mode");if(feed=r.getSelFeed(),e&&(!feed||0===feed.unread))return ruto.go("/"),void 0}ruto.back()}},r.getSel=function(e){return kind=void 0!==e?e:"home"===r.currentView?"feeds":r.currentView,kind?m[kind]:void 0},r.getSelFeed=function(){var e=r.getSel(),t=amplify.store("feeds-by-id");if("feeds"===e.name){var n=$(e.siz),i=n[e.sel];if(!i)return;var o=i.getAttribute("id").substring(5);return t[parseInt(o,10)]}return"feed"===e.name?t[r.feeds.currentID]:"article"===e.name?t[r.feeds.currentID]:void 0},r.scrollPage=function(e){window.scrollBy(0,60*e)},r.cmd_open=function(){location.href;var e,t=$("#opener");if("article"===r.currentView){if(articleA=$("#full_article"),!articleA)return;e=articleA.attr("href")}else if("feed"===r.currentView){var n=r.getSel();if(void 0===n)return;var i=r.feed.currentHeadlines;if(i&&n.sel<i.length){var o=i[n.sel];if(e=o.link,!e)return;r.feed.markRead(o,n.sel)}}if(e){t.attr("href",e);var a=document.createEvent("MouseEvents");"Mac"===u?a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!0,!1,!1,!0,0,null):a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!0,!1,!1,!1,0,null),t[0].dispatchEvent(a);var s=amplify.store("view-mode");return feed=r.getSelFeed(),!s||feed&&0!==feed.unread?void 0:(ruto.go("/"),void 0)}},r.cmd_click_feed=function(e){var t=r.getSel("feeds");t&&$(t.siz).removeClass("sel");var n=$(t.siz),i=n.indexOf(e);-1!=i&&(t.sel=i)},r.cmd_move_sel=function(e){var n=r.getSel();if(void 0!==n){if("article"===n.name)return r.scrollPage(e,n),void 0;
if(n.sel=n.sel+e,0>n.sel)return n.sel=0,void 0;if(items=$(n.siz),n.sel>=items.length)return n.sel=items.length-1,void 0;if(!(0===items.length||n.sel>=items.length)){$(items[n.sel-e]).removeClass("sel"),$(items[n.sel]).addClass("sel");var i=items[n.sel],o=i.offsetTop;document.body.clientHeight;var a=t(i);if(!a){var s=i.offsetHeight;if(0>e)document.body.scrollTop=o-(s-5);else{var l=s;document.body.scrollTop=document.body.scrollTop+l}}}}},e.ddd=r,r.config=window._ddd_config,delete window._ddd_config,ruto.config({before:function(e,t){r.hideAllViews();var n=$("#view-"+t);$(n).removeClass("hidden"),r.prevView=r.currentView,r.currentView=t},notfound:function(){ruto.go("/")}}).add("/","home",function(){r.feed.showSelection()}).add("/about","about").add("/settings","settings").add("/login","login").add("/login_submit",function(){r.login.attempt_login()}).add(/^\/feed\/(\d+)$/i,"feed",function(e,t){r.feed.render(t)}).add(/^\/feed\/(\w+)$/i,"feed",function(e,t){"starred"===t?id=-1:"published"===t?id=-2:"fresh"===t?id=-3:"all"===t?id=-4:"recent"===t&&(id=-6),r.feed.render(id)}).add(/^\/article\/(\d+)\/(\d+)$/i,"article",function(e,t,n){r.article.render(t,n-1)})},!dddns.poll){var poll=function(){dddns["ddd-plat"]&&dddns.ddd&&dddns.lib?(console.log("everything is loaded"),dddns.ddd(window),dddns["ddd-plat"](window),dddns.poll=1):setTimeout(dddns.poll,75)};dddns.poll=poll,setTimeout(poll,75)}if(dddns="undefined"==typeof dddns?{}:dddns,dddns["ddd-plat"]=function(e){console.log("dddd");var t=e.document,n=t.body,i={clockwise:["flip-out-to-left","flip-in-from-left"],anticlockwise:["flip-out-to-right","flip-in-from-right"]},r=function(e){var t=e.in,n=e.out,r=e.direction,o=e.fn,a=i[r],s=function(){$(t).off("webkitAnimationEnd",s,!1),$(n).addClass("hidden"),$(t).removeClass("flip"),$(n).removeClass("flip"),$(n).removeClass(a[0]),$(t).removeClass(a[1]),o&&o.apply()};$(t).removeClass("hidden"),$(n).addClass("flip"),$(t).addClass("flip"),$(t).on("webkitAnimationEnd",s,!1),$(n).addClass(a[0]),$(t).addClass(a[1])},o={rtl:["slide-out-to-left","slide-in-from-right"],ltr:["slide-out-to-right","slide-in-from-left"]},a=function(e){var t=e.in,n=e.out,i=e.direction,r=e.fn,a=o[i],s=function(){$(t).off("webkitAnimationEnd",s,!1),$(n).addClass("hidden"),$(t).removeClass("sliding"),$(n).removeClass("sliding"),$(n).removeClass(a[0]),$(t).removeClass(a[1]),r&&r.apply()};$(t).removeClass("hidden"),$(n).addClass("sliding"),$(t).addClass("sliding"),$(t).on("webkitAnimationEnd",s,!1),$(n).addClass(a[0]),$(t).addClass(a[1])},s=function(){return e.innerWidth>=640?"wide":"narrow"},l=t.querySelector("meta[name=viewport]");l||(l=t.createElement("meta"),l.name="viewport",t.head.appendChild(l)),l.content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0",console.log("hi");var d=navigator.userAgent,u=d&&/iPhone|iPod/.test(d),c=6>parseInt((d.match(/ OS (\d+)_/i)||[,0])[1],10);u&&c&&$(n).addClass("ios5"),console.log("hi2");var f="wide"==s();e.addEventListener("resize",function(){var e="wide"==s();e!=f&&(f=e,location.reload())}),n.insertAdjacentHTML("beforeend",f?'<div id="overlay" class="hide"></div>':'<header class="fake"></header>'),ruto.config({before:function(e,t,n){console.log("ddd path="+e+" name="+t+" matches=",n);var i=ddd.currentView,o=ddd.hideAllViews;switch(t){case"home":var s=$("#view-home");if(f){o(),$("#overlay").addClass("hide"),s.removeClass("hidden");var l=$("#view-feed");l.removeClass("hidden"),l.find("section").html('<div class="view-blank-state"><div class="view-blank-state-text">No Feed Selected.</div></div>'),l.find("header h1").innerHTML="",l.find("header a.header-back-button").css("display","none"),ddd.feeds.currentID=null,ddd.pub("selectCurrentStory")}else i?"about"==i?r({"in":s,out:$("#view-"+i),direction:"anticlockwise"}):"home"!=i&&a({"in":s,out:$("#view-"+i),direction:"ltr"}):(o(),s.removeClass("hidden"));ddd.currentView="home";break;case"about":var s=$("#view-about");f?(s.removeClass("hidden"),$("#view-home").removeClass("hidden"),$("#view-comments").removeClass("hidden"),setTimeout(function(){$("#overlay").removeClass("hide")},1)):i?"about"!=i&&r({"in":s,out:$("#view-home"),direction:"clockwise"}):(o(),s.removeClass("hidden")),ddd.currentView="about";break;case"login":console.log("LOGIN screen!!!!!!!!!!!!"),$("#overlay").removeClass("hide");var s=$("#view-login");f?(s.removeClass("hidden"),$("#view-home").removeClass("hidden"),$("#view-comments").removeClass("hidden"),setTimeout(function(){$("#overlay").removeClass("hide")},1)):i?"login"!=i&&r({"in":s,out:$("#view-home"),direction:"clockwise"}):(o(),s.removeClass("hidden")),ddd.currentView="login";break;case"feed":var s=$("#view-feed");if(f)o(),$("#overlay").addClass("hide"),s.removeClass("hidden"),$("#view-home").removeClass("hidden"),ddd.pub("selectCurrentStory",n[1]),s.find("header a.header-back-button").css("display","");else if(i){if("feed"!=i){var d=n[1];d&&ddd.feeds.currentID!=d&&(s.find("section").scrollTop=0),a({"in":s,out:$("#view-"+i),direction:"rtl"})}}else o(),s.removeClass("hidden");ddd.currentView="feed";break;case"article":var s=$("#view-article");if(f)o(),$("#overlay").addClass("hide"),s.removeClass("hidden"),$("#view-home").removeClass("hidden"),ddd.pub("selectCurrentStory",n[1]),s.find("header a.header-back-button").css("display","");else if(i){if("article"!=i){var d=n[1];d&&ddd.feeds.currentID!=d&&(s.find("section").scrollTop=0),a({"in":s,out:$("#view-"+i),direction:"rtl"})}}else o(),s.removeClass("hidden");ddd.currentView="article"}}}),e.addEventListener("pagehide",function(){for(var e=$(".view"),t={},n=0,i=e.length;i>n;n++){var r=e[n];t[r.id]=r.querySelector(".scroll section").scrollTop||0}amplify.store("hacker-scrolltops",t)},!1);var p=function(){var e=amplify.store("hacker-scrolltops");setTimeout(function(){for(var t in e)$("#"+t).querySelector(".scroll section").scrollTop=e[t]},1)};if(e.addEventListener("pageshow",p,!1),p(),u){var h=t.querySelectorAll(".view>.scroll"),m=null;Array.prototype.forEach.call(h,function(i){i.addEventListener("touchstart",function(){if(e.innerHeight!=m){if(e.scrollTo(0,0),c){var i=t.createElement("div");i.style.height="600px",n.appendChild(i),setTimeout(function(){n.removeChild(i)},100)}m=e.innerHeight}},!1)})}tappable(".view>header a.header-button[href]",{noScroll:!0,onTap:function(e,t){var n=t.hash;f&&/about/i.test(ruto.current)&&"#/"==n?ruto.back("/"):location.hash=n}}),tappable("#view-home-refresh",{noScroll:!0,onTap:ddd.feeds.reload});var v=!1;tappable(".view>header h1",{onTap:function(e,t){var i=t.parentNode.nextElementSibling.firstElementChild;if(0==i.scrollTop||v){if(u){var r=n.style.height;n.style.height="100%",setTimeout(function(){n.style.height=r},100)}}else{if(v)return;v=!0;var o=i.style.overflow;i.style.overflow="hidden",setTimeout(function(){i.style.overflow=o;var e,t=new TWEEN.Tween({scrollTop:i.scrollTop}).to({scrollTop:0},300).easing(TWEEN.Easing.Cubic.InOut).onUpdate(function(){i.scrollTop=this.scrollTop}).onComplete(function(){cancelAnimationFrame(e),t.stop(),v=!1,delete t}).start(),n=function(){TWEEN.update(),requestAnimationFrame(n)};e=requestAnimationFrame(n)},200)}}});var g;tappable("#view-home .tableview-links li>a:first-child",{allowClick:!f,activeClassDelay:100,inactiveClassDelay:f?100:1e3,onStart:function(e,t){if(f){var n=t.parentNode;n&&(n=n.parentNode,g=setTimeout(function(){n&&$(n).addClass("list-tapped")},100))}},onMove:function(){f&&clearTimeout(g)},onEnd:function(e,t){if(f){clearTimeout(g);var n=t.parentNode.parentNode;setTimeout(function(){n&&$(n).removeClass("list-tapped")},100)}},onTap:function(t,n){n.classList.contains("more-link")?ddd.news.more(n):/^#\//.test(n.getAttribute("href"))?location.hash=n.hash:n.href&&f&&e.open(n.href)}}),tappable("#view-about .grouped-tableview-links li>a:first-child",{allowClick:!0,activeClassDelay:100,inactiveClassDelay:1e3}),tappable("#view-home .tableview-links li>a.detail-disclosure-button",{noScroll:!0,noScrollDelay:100,onTap:function(e,t){location.hash=t.hash}}),tappable("button.comments-toggle",function(e,t){ddd.comments.toggle(t)}),tappable("section.comments li>a.more-link",function(e,t){ddd.comments.more(t)}),tappable("#login ",function(){ddd.login.doLogin()}),ddd.sub("selectCurrentStory",function(e){if(console.log("on selectCurrentStory "+e+" widescreen="+f),f){e||(e=(location.hash.match(/feed\/(\d+)/)||[,""])[1]);for(var t=$("#view-home"),n=t.find("a[href].selected"),i=0,r=n.length;r>i;i++)$(n[i]).removeClass("selected");if(e){var o=t.find('a[href*="feed/'+e+'"]');console.log("link is",o),o.length>0&&($(o).addClass("selected"),setTimeout(function(){o[0].scrollIntoViewIfNeeded?o[0].scrollIntoViewIfNeeded():o[0].scrollIntoView()},1))}}}),ddd.sub("onRenderNews",function(){ddd.pub("selectCurrentStory")}),e.addEventListener("pageshow",function(){setTimeout(function(){"home"==ddd.currentView&&$("#feedslist")&&!amplify.store("ddd-cached")&&ddd.news.reload()},1)},!1);var b=function(){var e=t.querySelector("#view-comments section");if(e){var n=e.querySelector(".post-content"),i=e.querySelector(".comments");if(i){var r=e.offsetHeight-n.offsetHeight+1,o=$("#comment-section-style");o||(o=t.createElement("style"),o.id="comment-section-style",t.head.appendChild(o)),o.textContent=".view section.comments{min-height: "+r+"px;}"}}};ddd.sub("onRenderComments",function(){setTimeout(b,f?1:360)}),e.addEventListener("resize",b,!1),e.addEventListener("orientationchange",b,!1);var y=e.orientation!==void 0,w=function(){y&&(n.style.height=screen.height+"px",setTimeout(function(){e.scrollTo(0,0),n.style.height=e.innerHeight+"px"},1))};if(f){var T=$("#apploader");T.remove()}else"complete"==t.readyState?w():e.addEventListener("load",w,!1),y&&(e.onorientationchange=w),setTimeout(function(){var e=$("#apploader");e&&(e.addClass("hide"),e.on("webkitTransitionEnd",function(){e.remove()},!1))},200);ddd.init(),ddd.feeds.render()},!dddns.poll){var poll=function(){dddns["ddd-plat"]&&dddns.ddd&&dddns.lib?(console.log("everything is loaded"),dddns.ddd(window),dddns["ddd-plat"](window),dddns.poll=1):setTimeout(dddns.poll,75)};dddns.poll=poll,setTimeout(poll,75)}
//@ sourceMappingURL=ddd.min/ddd.min.ios.js.map